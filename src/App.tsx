import {Reset} from "styled-reset";
import {Typography, Table, Flex, Button, TablePaginationConfig} from "antd";
import styles from "./App.module.css"
import {API_URL, HTTPS_SHEMA} from "./const.ts";
import {useEffect, useState} from "react";
import {siteItem} from "./types.ts";
import {ColumnsType} from "antd/es/table";
import axios from 'axios';

function App() {

    const [rating, setRating] = useState<siteItem[]>()

    const fetchRating = async () => {
        const response = await axios.get(API_URL + "/get_all_rating")
        setRating(response.data)
    }

    useEffect(() => {
        fetchRating()
    }, [])

    const columns:ColumnsType = [
        {
            title: '–ú–µ—Å—Ç–æ',
            dataIndex: 'key',
            key: 'key',
            align: 'center' as const,
        },
        {
            title: '–°–∞–π—Ç',
            dataIndex: 'site',
            key: 'site',
            align: 'center' as const,
        },
        {
            title: '–ö–æ–ª-–≤–æ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã—Ö —Å–ª–æ–≤',
            dataIndex: 'aggressive_words',
            key: 'aggressive_words',
            align: 'center' as const,
        },
        {
            title: '–°—Å—ã–ª–∫–∞ –Ω–∞ —Å–∞–π—Ç',
            key: 'key',
            dataIndex: 'key',
            align: 'center' as const,
            render: (_:string, record) => (
                <a href={HTTPS_SHEMA + record.site} target="_blank">
                    <Button>
                        –û—Ç–∫—Ä—ã—Ç—å
                    </Button>
                </a>
            ),
        },
    ];

    const paginationConfig: TablePaginationConfig = {
        pageSize: 5
    } as TablePaginationConfig

    return (
        <>
            <Reset />
            <Flex className={styles.wrapper}>
                <Flex vertical gap="middle" className={styles.container}>
                    <Typography.Title level={1}>–†–µ–π—Ç–∏–Ω–≥ –±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö —Å–∞–π—Ç–æ–≤ üèÜ</Typography.Title>
                    <Table dataSource={rating} columns={columns} pagination={paginationConfig} />
                </Flex>
            </Flex>
        </>
    )
}

export default App
